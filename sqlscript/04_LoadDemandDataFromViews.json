{
	"name": "04_LoadDemandDataFromViews",
	"properties": {
		"content": {
			"query": "\n-- Create the aggregated demand external table Zone level\n\n--DROP EXTERNAL TABLE HourlyZoneDemand\n--DROP EXTERNAL TABLE HourlyBoroughDemand\n--DROP EXTERNAL TABLE supplySummary\n--DROP EXTERNAL TABLE HourlyOverSupply\n--DROP EXTERNAL TABLE HourlyUnderSupply\n\n-- Don't forget to also delete the location directory from the  \n\nCREATE EXTERNAL TABLE HourlyZoneDemand\nWITH (\n    LOCATION = 'agg_Zonedemand/',\n    DATA_SOURCE = taxiDataDemo,  \n    FILE_FORMAT = taxiData_file_format\n)  \nAS\nSELECT * from dbo.vHourlyZoneDemand\n\n-- Create the aggregated demand external table Borough level\nCREATE EXTERNAL TABLE HourlyBoroughDemand\nWITH (\n    LOCATION = 'agg_Boroughdemand/',\n    DATA_SOURCE = taxiDataDemo,  \n    FILE_FORMAT = taxiData_file_format\n)  \nAS\nSELECT * from dbo.vHourlyBoroughDemand\n\n\n-- Create the aggregated supply external table \nCREATE EXTERNAL TABLE supplySummary\nWITH (\n    LOCATION = 'agg_supply/',\n    DATA_SOURCE = taxiDataDemo,  \n    FILE_FORMAT = taxiData_file_format\n)  \nAS\nSELECT * from vHourlySupply\n\n-- Create the zone over supply for deployment \nCREATE EXTERNAL TABLE HourlyOverSupply\nWITH (\n    LOCATION = 'agg_overSupply/',\n    DATA_SOURCE = taxiDataDemo,  \n    FILE_FORMAT = taxiData_file_format\n)  \nAS\nSELECT * from vHourlyOverSupply\n\n-- Create the zone under supply for deployment \nCREATE EXTERNAL TABLE HourlyUnderSupply\nWITH (\n    LOCATION = 'agg_underSupply/',\n    DATA_SOURCE = taxiDataDemo,  \n    FILE_FORMAT = taxiData_file_format\n)  \nAS\nSELECT * from vHourlyUnderSupply\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "Built-in",
				"databaseName": "nyctaxiDB"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}